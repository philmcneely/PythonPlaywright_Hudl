<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Test Execution Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.5; }
        h1 { margin-bottom: 8px; }
        .muted { color: #666; margin-bottom: 24px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit,minmax(280px,1fr)); gap: 16px; }
        .card { border: 1px solid #ddd; padding: 16px; border-radius: 8px; }
        .card h3 { margin-top: 0; }
        a.btn { display: inline-block; margin: 6px 0; padding: 8px 10px; background: #f5f5f5; text-decoration: none; border-radius: 6px; color: inherit; }
        a.btn:hover { background: #e9e9e9; }
        .list { margin-top: 4px; }
        .list a { display: block; margin: 4px 0; text-decoration: none; }
        .list a:hover { text-decoration: underline; }
        .empty { color: #999; font-style: italic; }
        .footer { margin-top: 32px; font-size: 0.9rem; color: #777; }
        code { background: #00000010; padding: 2px 6px; border-radius: 4px; }
        .commit { font-size: 0.95em; color: #555; }
        .status-pass { color: green; font-weight: bold; }
        .status-fail { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ðŸš€ Test Execution Dashboard</h1>
    <div class="muted">Updated: <code id="updated"></code></div>

    <div class="grid">
        <div class="card">
            <h3>ðŸ”¥ Main: Smoke Tests</h3>
            <a class="btn" href="/PythonPlaywright_Hudl/smoke/chromium/">Chromium Smoke</a>
            <a class="btn" href="/PythonPlaywright_Hudl/smoke/firefox/">Firefox Smoke</a>
        </div>
        <div class="card">
            <h3>ðŸŽ¯ Main: Full Tests</h3>
            <a class="btn" href="/PythonPlaywright_Hudl/full/chromium/">Chromium Full</a>
            <a class="btn" href="/PythonPlaywright_Hudl/full/firefox/">Firefox Full</a>
        </div>
        <div class="card" id="pr-card">
            <h3>ðŸ§ª PR Dashboards (by branch & commit, newest first)</h3>
            <div class="list" id="pr-list">
                <div class="empty">No PR dashboards published yet.</div>
            </div>
        </div>
    </div>

    <div class="footer">Note: PR dashboards are under pr/&lt;branch&gt;/dashboard/&lt;commit&gt;.</div>

    <script>
        document.getElementById('updated').textContent = new Date().toISOString();
        // Injected by the workflow:
        const PR_DASHBOARDS = [
                    { branch: "JIRA-2346_add_perf_metrics", commit: "d3a96d39452875d5e4881bb1c6cd6e0b862dead4", url: "/PythonPlaywright_Hudl/pr/JIRA-2346_add_perf_metrics/dashboard/d3a96d39452875d5e4881bb1c6cd6e0b862dead4/", status: "pass" },
                    { branch: "JIRA-2346_add_perf_metrics", commit: "b8dd9ef9376b284bc30f803cac37c31c184e4f4c", url: "/PythonPlaywright_Hudl/pr/JIRA-2346_add_perf_metrics/dashboard/b8dd9ef9376b284bc30f803cac37c31c184e4f4c/", status: "pass" },
                    { branch: "JIRA-2346_add_perf_metrics", commit: "4eb8de29884f8738e045b2aef60c2c7b99a6fe0e", url: "/PythonPlaywright_Hudl/pr/JIRA-2346_add_perf_metrics/dashboard/4eb8de29884f8738e045b2aef60c2c7b99a6fe0e/", status: "unknown" },
        ];
        // Group by branch
        const grouped = {};
        PR_DASHBOARDS.forEach(item => {
          if (!grouped[item.branch]) grouped[item.branch] = [];
          grouped[item.branch].push(item);
        });
        const prListEl = document.getElementById('pr-list');
        if (PR_DASHBOARDS.length > 0) {
            prListEl.innerHTML = '';
            Object.keys(grouped).forEach(branch => {
              const branchDiv = document.createElement('div');
              branchDiv.innerHTML = `<b>${branch}</b>`;
              grouped[branch].forEach(item => {
                const a = document.createElement('a');
                a.href = item.url;
                let statusClass = item.status === "pass" ? "status-pass" : (item.status === "fail" ? "status-fail" : "");
                a.innerHTML = `<span class="commit">${item.commit.slice(0,8)}</span> &rarr; dashboard <span class="${statusClass}">${item.status.toUpperCase()}</span>`;
                branchDiv.appendChild(a);
              });
              prListEl.appendChild(branchDiv);
            });
        }
    </script>
</body>
</html>
